'use strict';

// TODO Throw exeption if there is no signID
// TODO Clean constructor in the end
// TODO isUser flag and ai setup are ugly
// Player constructor
TRIPLET.Player = function () {

  var cfg = TRIPLET.config.general,
      rule = TRIPLET.config.rules,
      ai = TRIPLET.config.ai,
      _Player;

  _Player = function Player(setup, index) {
    if (!(this instanceof _Player)) return new _Player(setup, index);
    this.queue = parseInt(index, 10);
    this.signID = setup.signID;
    this.name = setup.name || 'Player';
    this.color = setup.color || '000000';
    this.isUser = !setup.ai || setup.ai === 'none';
    this.ai = this.isUser ? ai.none : ai[setup.ai];
    this.maxTurns = this.getTurnsCount(cfg.maxTurns);
  };

  _Player.prototype = {

    constructor: _Player,

    getTurnsCount: function getTurnsCount(totalTurns) {
      var endedRoundsTurns = ~ ~(totalTurns / rule.turnsPerRound) * rule.signsPerRound,
          thisRoundTurns = totalTurns % rule.turnsPerRound - rule.signsPerRound * this.queue;
      return endedRoundsTurns + Math.max(0, Math.min(rule.signsPerRound, thisRoundTurns));
    }

  };

  return _Player;
}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3BsYXllci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFJQSxRQUFRLE1BQVIsR0FBa0IsWUFBVzs7QUFFN0IsTUFBSSxNQUFNLFFBQVEsTUFBUixDQUFlLE9BQXpCO01BQ0ksT0FBTyxRQUFRLE1BQVIsQ0FBZSxLQUQxQjtNQUVJLEtBQUssUUFBUSxNQUFSLENBQWUsRUFGeEI7TUFHSSxPQUhKOztBQUtBLFlBQVMsZ0JBQVMsS0FBVCxFQUFnQixLQUFoQixFQUF1QjtBQUM5QixRQUFJLEVBQUUsZ0JBQWdCLE9BQWxCLENBQUosRUFBK0IsT0FBTyxJQUFJLE9BQUosQ0FBVyxLQUFYLEVBQWtCLEtBQWxCLENBQVA7QUFDL0IsU0FBSyxLQUFMLEdBQWEsU0FBUyxLQUFULEVBQWdCLEVBQWhCLENBQWI7QUFDQSxTQUFLLE1BQUwsR0FBYyxNQUFNLE1BQXBCO0FBQ0EsU0FBSyxJQUFMLEdBQVksTUFBTSxJQUFOLElBQWMsUUFBMUI7QUFDQSxTQUFLLEtBQUwsR0FBYSxNQUFNLEtBQU4sSUFBZSxRQUE1QjtBQUNBLFNBQUssTUFBTCxHQUFjLENBQUMsTUFBTSxFQUFQLElBQWEsTUFBTSxFQUFOLEtBQWEsTUFBeEM7QUFDQSxTQUFLLEVBQUwsR0FBVSxLQUFLLE1BQUwsR0FBYyxHQUFHLElBQWpCLEdBQXdCLEdBQUcsTUFBTSxFQUFULENBQWxDO0FBQ0EsU0FBSyxRQUFMLEdBQWdCLEtBQUssYUFBTCxDQUFtQixJQUFJLFFBQXZCLENBQWhCO0FBQ0QsR0FURDs7QUFXQSxVQUFPLFNBQVAsR0FBbUI7O0FBRWpCLGlCQUFhLE9BRkk7O0FBSWpCLG1CQUFlLHVCQUFTLFVBQVQsRUFBcUI7QUFDbEMsVUFBSSxtQkFDSSxFQUFDLEVBQUUsYUFBYSxLQUFLLGFBQXBCLENBQUQsR0FBc0MsS0FBSyxhQURuRDtVQUVJLGlCQUNJLGFBQWEsS0FBSyxhQUFsQixHQUFrQyxLQUFLLGFBQUwsR0FBcUIsS0FBSyxLQUhwRTtBQUlBLGFBQU8sbUJBQ0gsS0FBSyxHQUFMLENBQVMsQ0FBVCxFQUFZLEtBQUssR0FBTCxDQUFTLEtBQUssYUFBZCxFQUE2QixjQUE3QixDQUFaLENBREo7QUFFRDs7QUFYZ0IsR0FBbkI7O0FBZUEsU0FBTyxPQUFQO0FBRUMsQ0FuQ2dCLEVBQWpCIiwiZmlsZSI6ImpzL3BsYXllci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFRPRE8gVGhyb3cgZXhlcHRpb24gaWYgdGhlcmUgaXMgbm8gc2lnbklEXHJcbi8vIFRPRE8gQ2xlYW4gY29uc3RydWN0b3IgaW4gdGhlIGVuZFxyXG4vLyBUT0RPIGlzVXNlciBmbGFnIGFuZCBhaSBzZXR1cCBhcmUgdWdseVxyXG4vLyBQbGF5ZXIgY29uc3RydWN0b3JcclxuVFJJUExFVC5QbGF5ZXIgPSAoZnVuY3Rpb24oKSB7XHJcblxyXG52YXIgY2ZnID0gVFJJUExFVC5jb25maWcuZ2VuZXJhbCxcclxuICAgIHJ1bGUgPSBUUklQTEVULmNvbmZpZy5ydWxlcyxcclxuICAgIGFpID0gVFJJUExFVC5jb25maWcuYWksXHJcbiAgICBQbGF5ZXI7XHJcblxyXG5QbGF5ZXIgPSBmdW5jdGlvbihzZXR1cCwgaW5kZXgpIHtcclxuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUGxheWVyKSkgcmV0dXJuIG5ldyBQbGF5ZXIoc2V0dXAsIGluZGV4KTtcclxuICB0aGlzLnF1ZXVlID0gcGFyc2VJbnQoaW5kZXgsIDEwKTtcclxuICB0aGlzLnNpZ25JRCA9IHNldHVwLnNpZ25JRDtcclxuICB0aGlzLm5hbWUgPSBzZXR1cC5uYW1lIHx8ICdQbGF5ZXInO1xyXG4gIHRoaXMuY29sb3IgPSBzZXR1cC5jb2xvciB8fCAnMDAwMDAwJztcclxuICB0aGlzLmlzVXNlciA9ICFzZXR1cC5haSB8fCBzZXR1cC5haSA9PT0gJ25vbmUnO1xyXG4gIHRoaXMuYWkgPSB0aGlzLmlzVXNlciA/IGFpLm5vbmUgOiBhaVtzZXR1cC5haV07XHJcbiAgdGhpcy5tYXhUdXJucyA9IHRoaXMuZ2V0VHVybnNDb3VudChjZmcubWF4VHVybnMpO1xyXG59O1xyXG5cclxuUGxheWVyLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgY29uc3RydWN0b3I6IFBsYXllcixcclxuXHJcbiAgZ2V0VHVybnNDb3VudDogZnVuY3Rpb24odG90YWxUdXJucykge1xyXG4gICAgdmFyIGVuZGVkUm91bmRzVHVybnMgPVxyXG4gICAgICAgICAgICB+fih0b3RhbFR1cm5zIC8gcnVsZS50dXJuc1BlclJvdW5kKSAqIHJ1bGUuc2lnbnNQZXJSb3VuZCxcclxuICAgICAgICB0aGlzUm91bmRUdXJucyA9XHJcbiAgICAgICAgICAgIHRvdGFsVHVybnMgJSBydWxlLnR1cm5zUGVyUm91bmQgLSBydWxlLnNpZ25zUGVyUm91bmQgKiB0aGlzLnF1ZXVlO1xyXG4gICAgcmV0dXJuIGVuZGVkUm91bmRzVHVybnMgK1xyXG4gICAgICAgIE1hdGgubWF4KDAsIE1hdGgubWluKHJ1bGUuc2lnbnNQZXJSb3VuZCwgdGhpc1JvdW5kVHVybnMpKTtcclxuICB9XHJcblxyXG59O1xyXG5cclxucmV0dXJuIFBsYXllcjtcclxuXHJcbn0pKCk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
